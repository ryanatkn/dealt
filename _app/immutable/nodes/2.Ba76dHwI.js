var at=Object.defineProperty;var Ne=o=>{throw TypeError(o)};var rt=(o,e,a)=>e in o?at(o,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):o[e]=a;var ye=(o,e,a)=>rt(o,typeof e!="symbol"?e+"":e,a),st=(o,e,a)=>e.has(o)||Ne("Cannot "+a);var se=(o,e,a)=>(st(o,e,"read from private field"),a?a.call(o):e.get(o)),we=(o,e,a)=>e.has(o)?Ne("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(o):e.set(o,a);import{t as x,a as h,c as ue,b as ke,h as nt}from"../chunks/B-9WnmWB.js";import{p as E,c as r,s as i,w as l,x as F,r as t,t as D,a as J,f as B,ah as N,_ as z,u as me,n as te,ai as it,$ as lt}from"../chunks/CsJOpq0I.js";import{s as Se}from"../chunks/kQ0gKvDQ.js";import{a as ot,A as ct,d as _t,D as vt}from"../chunks/BRTXOQ4E.js";import{g as De,y as dt,z as ut,A as mt,e as pe,B as pt,p as Le,F as Oe,I as ft,J as ht,j as gt,R as bt,c as xt,E as yt,r as wt}from"../chunks/CubLvqG9.js";import{s as P,d as G,o as jt}from"../chunks/CS7d4eST.js";import{i as C,p as V}from"../chunks/CPwzJCGN.js";import{a as Ie,d as zt,f as kt,C as St,s as U,g as Pe,b as je,c as Me,r as ne,i as ze}from"../chunks/DK50TLbw.js";import{t as O,a as Dt,s as M}from"../chunks/DoGG4ls-.js";import{S as We,c as Pt,g as Tt}from"../chunks/BJjicHN9.js";import{b as Fe}from"../chunks/DbrjjpyB.js";import{D as Re}from"../chunks/Cy3N2eyA.js";import{b as At}from"../chunks/K5p_LvbD.js";import{o as Ve}from"../chunks/CaPnxLGq.js";import{B as Ct}from"../chunks/-ttB3QE2.js";var Bt=x('<span class="font_family_mono"> </span>'),Et=x("<a><!> <!></a>");function Jt(o,e){E(e,!0);const a=F(()=>e.path.startsWith("https://")?e.path:`https://developer.mozilla.org/en-US/docs/${zt(e.path,"/")}`),s=F(()=>e.children??kt(e.path,"/").split("/").at(-1));var v=Et();let p;var m=r(v);We(m,{data:Pt,inline:!0,size:"var(--icon_size_xs)",attrs:{class:"mx_xs3"}});var f=i(m,2);{var c=d=>{var _=Bt(),g=r(_,!0);t(_),D(()=>P(g,l(s))),h(d,_)},n=d=>{var _=ue(),g=B(_);Se(g,()=>l(s)),h(d,_)};C(f,d=>{typeof l(s)=="string"?d(c):d(n,!1)})}t(v),D(()=>p=Ie(v,p,{...e.attrs,href:l(a),class:"chip white_space_nowrap"})),h(o,v),J()}var Nt=x("<div>✓</div>"),Ft=x("<div>⧉</div>"),Lt=x("<button><!></button>");function Te(o,e){E(e,!0);const a=V(e,"copied_display_duration",3,1e3),s=V(e,"icon_button",3,!0);let v=N(!1),p=N(!1),m;const f=async u=>{var b;if(clearTimeout(m),e.text!==null){z(v,!1),z(p,!1);try{await navigator.clipboard.writeText(e.text),z(v,!0)}catch{z(p,!0);return}m=setTimeout(()=>{z(v,!1)},a()),(b=e.oncopy)==null||b.call(e,e.text,u)}};var c=Lt();let n;var d=r(c);{var _=u=>{var b=ue(),w=B(b);Se(w,()=>e.children,()=>l(v),()=>l(p)),h(u,b)},g=(u,b)=>{{var w=k=>{var T=Nt();O(1,T,()=>Dt,()=>({duration:200})),h(k,T)},j=k=>{var T=Ft();O(1,T,()=>M),h(k,T)};C(u,k=>{l(v)?k(w):k(j,!1)},b)}};C(d,u=>{e.children?u(_):u(g,!1)})}t(c),D(u=>{var b,w;return n=Ie(c,n,{type:"button",title:"copy to clipboard",...e.attrs,class:(b=e.attrs)==null?void 0:b.class,onclick:f,disabled:((w=e.attrs)==null?void 0:w.disabled)??(e.allow_copying_empty_string?e.text===null:!e.text),[St]:u})},[()=>({icon_button:e.children?!1:s(),copied:l(v),failed:l(p),color_c:l(p)})]),h(o,c),J()}var ie,le;class de{constructor(e,a){we(this,ie,N());ye(this,"serialize");ye(this,"parse");we(this,le,F(()=>this.serialize(this.value)));this.value=e,this.serialize=(a==null?void 0:a.serialize)??(s=>JSON.stringify(s,null,2)),this.parse=(a==null?void 0:a.parse)??JSON.parse}get value(){return l(se(this,ie))}set value(e){z(se(this,ie),e,!0)}get serialized(){return l(se(this,le))}set serialized(e){z(se(this,le),e)}set_from_serialized(e){this.value=this.parse(e)}}ie=new WeakMap,le=new WeakMap;var Ot=x('<p class="color_c_5"><strong> </strong></p>'),It=x('<form><div class="display_flex mb_md gap_md"><button type="button"> </button> <!></div> <textarea></textarea> <!></form>');function Ue(o,e){E(e,!0);const a=V(e,"parse_error",3,"failed to parse data - is it valid JSON?"),s=V(e,"title",3,"data"),v=V(e,"name",3,""),p=F(()=>e.data&&e.data instanceof de?e.data:new de(e.data)),m=F(()=>l(p).serialized);let f=N(void 0),c=N(""),n=N(null);const d=()=>{var S,A;if(!l(c)){(S=l(f))==null||S.focus();return}let y;try{y=l(p).parse(l(c))}catch{z(n,a());return}z(n,null),z(c,""),(A=e.onimport)==null||A.call(e,y,l(c))};me(()=>{l(c),z(n,null)});var _=It(),g=r(_),u=r(g);u.__click=d;var b=r(u);t(u);var w=i(u,2);Te(w,{get text(){return l(m)},oncopy:async()=>{var y,S;z(c,l(m),!0),await it(),(y=l(f))==null||y.select(),(S=l(f))==null||S.focus()},children:(y,S)=>{te();var A=ke();D(()=>P(A,`⧉ copy ${s()??""}`)),h(y,A)},$$slots:{default:!0}}),t(g);var j=i(g,2);jt(j),At(j,y=>z(f,y),()=>l(f));var k=i(j,2);{var T=y=>{var S=Ot(),A=r(S),H=r(A,!0);t(A),t(S),D(()=>P(H,l(n))),O(3,S,()=>M),h(y,S)};C(k,y=>{l(n)&&y(T)})}t(_),D(()=>{u.disabled=l(c)===l(m),P(b,`↦ import ${s()??""}`),U(j,"placeholder",`${v()?v()+" ":""}JSON to import`)}),De(j,()=>l(c),y=>z(c,y)),h(o,_),J()}G(["click"]);var Mt=x('<div class="panel position_relative"><pre class="p_xs mb_0 svelte-1a9oeig"> </pre> <div class="position_absolute"><!></div></div>'),Wt=x('<h2 class="mt_xl">Scene data</h2> <section><!></section> <!>',1);function qe(o,e){E(e,!0);const a=F(()=>dt(e.scene)),s=F(()=>new de(l(a)));var v=Wt(),p=i(B(v),2),m=r(p);Ue(m,{get data(){return l(s)},title:"scene data",name:"Scene",onimport:(c,n)=>{var d;e.scene.reset(c),(d=e.onimport)==null||d.call(e,c,n)}}),t(p);var f=i(p,2);Re(f,{summary:n=>{te();var d=ke("View raw scene data");h(n,d)},children:(n,d)=>{var _=Mt(),g=r(_),u=r(g,!0);t(g);var b=i(g,2);Pe(b,"",{},{right:"var(--font_size_lg)",top:"var(--font_size_lg)"});var w=r(b);Te(w,{get text(){return l(s).serialized}}),t(b),t(_),D(()=>P(u,l(s).serialized)),h(n,_)},$$slots:{summary:!0,default:!0}}),h(o,v),J()}var Rt=(o,e,a)=>{const s=e.create();a.project.create_scene(s)},Vt=x('<button type="button"><span class="font_size_xl3 mr_sm"> </span> </button>'),Ut=x('<div><button type="button"> </button></div>'),qt=x('<h3>Load scene</h3> <section class="row gap_md flex_wrap"></section>',1),Gt=x('<h2 class="mt_xl">Scenes</h2> <h3>Create new scene</h3> <section class="row gap_md flex_wrap"></section> <!>',1);function Ge(o,e){E(e,!0);var a=Gt(),s=i(B(a),4);je(s,20,()=>ut,m=>m,(m,f)=>{var c=Vt();c.__click=[Rt,f,e];var n=r(c),d=r(n,!0);t(n);var _=i(n);t(c),D(()=>{U(c,"title",`create scene: ${f.name??""}`),P(d,f.glyph),P(_,` ${f.name??""}`)}),h(m,c)}),t(s);var v=i(s,2);{var p=m=>{var f=qt(),c=i(B(f),2);je(c,21,()=>e.project.scenes,n=>n.id,(n,d)=>{var _=Ut();const g=F(()=>e.project.selected_scene_id===l(d).id);var u=r(_);let b;u.__click=function(...j){var k;(k=l(g)?void 0:()=>{l(d).load(),e.project.select_scene(l(d).id)})==null||k.apply(this,j)};var w=r(u);t(u),t(_),D(j=>{b=Me(u,1,"white_space_nowrap",null,b,j),P(w,`${l(d).glyph??""}
					${l(d).name??""}`)},[()=>({selected:l(g)})]),O(3,_,()=>M,()=>({axis:"x"})),h(n,_)}),t(c),h(m,f)};C(v,m=>{e.project.scenes.length&&m(p)})}h(o,a),J()}G(["click"]);var Ht=(o,e,a)=>{const{value:s}=o.currentTarget;z(e,mt(s),!0),l(e)===null&&(a().glyph=s)},Kt=x('<div><strong class="color_c_5"> </strong></div>'),Qt=x('<header class="row mb_lg font_size_xl3"><span class="icon_size_lg pr_xl"> </span> </header> <form class="display_flex flex_column gap_md width_sm"><label><div class="title">name</div> <input placeholder="project name"></label> <label><div class="title">glyph</div> <input placeholder="project glyph"> <!></label></form>',1);function Xt(o,e){E(e,!0);const a=V(e,"project",7);let s=N(null);var v=Qt(),p=B(v),m=r(p),f=r(m,!0);t(m);var c=i(m);t(p);var n=i(p,2),d=r(n),_=i(r(d),2);ne(_),t(d);var g=i(d,2),u=i(r(g),2);ne(u),u.__input=[Ht,s,a];var b=i(u,2);{var w=j=>{var k=Kt(),T=r(k),y=r(T,!0);t(T),t(k),D(()=>P(y,l(s))),O(3,k,()=>M),h(j,k)};C(b,j=>{l(s)&&j(w)})}t(g),t(n),D(()=>{P(f,a().glyph),P(c,` ${a().name??""}`),U(_,"title",`project name for ${a().glyph??""}`),ze(u,a().glyph),U(u,"title",`project glyph for ${a().name??""}`)}),De(_,()=>a().name,j=>a().name=j),h(o,v),J()}G(["input"]);var Yt=(o,e)=>z(e,!l(e)),Zt=(o,e,a,s)=>{e.project.delete_scene(a.scene.id),z(s,!1)},$t=x('<div><button type="button" class="w_100 color_c selected deselectable"><div class="font_size_xl3">✕</div> <div class="ml_lg text_align_left">permanently delete scene<br> </div></button></div>'),ea=x('<button type="button" class="w_100 color_c">delete scene</button> <!>',1);function ta(o,e){E(e,!0);const a=pe.get();let s=N(!1);me(()=>{e.scene.id,z(s,!1)});var v=ea(),p=B(v);p.__click=[Yt,s];var m=i(p,2);{var f=c=>{var n=$t(),d=r(n);d.__pointerup=[Zt,a,e,s];var _=i(r(d),2),g=i(r(_),2);t(_),t(d),t(n),D(()=>P(g,`${e.scene.glyph??""}
				${e.scene.name??""}`)),O(3,n,()=>M),h(c,n)};C(m,c=>{l(s)&&c(f)})}h(o,v),J()}G(["click","pointerup"]);var aa=(o,e,a)=>{const{value:s}=o.currentTarget;z(e,pt(s),!0),l(e)===null&&(a().glyph=s)},ra=x('<div><strong class="color_c_5"> </strong></div>'),sa=(o,e)=>e().save(),na=(o,e)=>e().project.duplicate_scene(e()),ia=x('<form class="display_flex flex_column gap_md width_sm"><fieldset><label><div class="title">name</div> <input placeholder="scene name" title="scene name"></label> <label><div class="title">glyph</div> <input placeholder="scene glyph"> <!></label> <label><div class="title">id</div> <input disabled title="scene id"></label></fieldset> <fieldset class="gap_md"><button type="button" class="color_a">save scene</button> <button type="button">duplicate scene</button></fieldset> <fieldset><h3 class="color_c_5">Delete scene</h3> <!></fieldset></form>');function He(o,e){E(e,!0);const a=V(e,"scene",7);let s=N(null);var v=ia(),p=r(v),m=r(p),f=i(r(m),2);ne(f),t(m);var c=i(m,2),n=i(r(c),2);ne(n),n.__input=[aa,s,a];var d=i(n,2);{var _=y=>{var S=ra(),A=r(S),H=r(A,!0);t(A),t(S),D(()=>P(H,l(s))),O(3,S,()=>M),h(y,S)};C(d,y=>{l(s)&&y(_)})}t(c);var g=i(c,2),u=i(r(g),2);ne(u),t(g),t(p);var b=i(p,2),w=r(b);w.__click=[sa,a];var j=i(w,2);j.__click=[na,a],t(b);var k=i(b,2),T=i(r(k),2);ta(T,{get scene(){return a()}}),t(k),t(v),D(()=>{ze(n,a().glyph),U(n,"title",`scene glyph for ${a().name??""}`),ze(u,a().id)}),De(f,()=>a().name,y=>a().name=y),h(o,v),J()}G(["input","click"]);var la=x('<div class="panel position_relative"><pre class="p_xs mb_0 svelte-1a9oeig"> </pre> <div class="position_absolute"><!></div></div>'),oa=x('<h2 class="mt_xl">Project data</h2> <section><!></section> <!>',1);function ca(o,e){E(e,!0);const a=F(()=>new de(e.project.json));var s=oa(),v=i(B(s),2),p=r(v);Ue(p,{get data(){return l(a)},title:"project data",name:"Project",onimport:(f,c)=>{var n;e.project.set_json(Le(f)),(n=e.onimport)==null||n.call(e,f,c)}}),t(v);var m=i(v,2);Re(m,{summary:c=>{te();var n=ke("View raw project data");h(c,n)},children:(c,n)=>{var d=la(),_=r(d),g=r(_,!0);t(_);var u=i(_,2);Pe(u,"",{},{right:"var(--font_size_lg)",top:"var(--font_size_lg)"});var b=r(u);Te(b,{get text(){return l(a).serialized}}),t(u),t(d),D(()=>P(g,l(a).serialized)),h(c,d)},$$slots:{summary:!0,default:!0}}),h(o,s),J()}var _a=(o,e)=>z(e,!l(e)),va=(o,e,a,s)=>{var v;e.delete_project(a.project.id),z(s,!1),(v=o.currentTarget.closest(".dialog"))==null||v.scrollTo({top:0,behavior:"smooth"})},da=x('<div><button type="button" class="w_100 color_c selected deselectable"><div class="font_size_xl3">✕</div> <div class="ml_lg text_align_left">permanently delete project<br> </div></button></div>'),ua=x('<button type="button" class="w_100 color_c">delete project</button> <!>',1);function ma(o,e){E(e,!0);const a=pe.get();let s=N(!1);me(()=>{e.project.id,z(s,!1)});var v=ua(),p=B(v);p.__pointerup=[_a,s];var m=i(p,2);{var f=c=>{var n=da(),d=r(n);d.__pointerup=[va,a,e,s];var _=i(r(d),2),g=i(r(_),2);t(_),t(d),t(n),D(()=>P(g,`${e.project.glyph??""}
				${e.project.name??""}`)),O(3,n,()=>M),h(c,n)};C(m,c=>{l(s)&&c(f)})}h(o,v),J()}G(["pointerup"]);var pa=x('<div class="w_100 py_xs"><button type="button"><div class="font_size_xl3 mr_lg"> </div> <div class="ellipsis"> </div></button></div>'),fa=(o,e)=>{e.create_project(Le({name:ht(e.projects),scenes:[ft(gt())]}))},ha=x('<div class="pane p_lg width_sm"><h2 class="mt_0 mb_lg row pr_md"><span class="icon_size_md mr_lg">🏞</span> projects</h2> <div class="display_flex flex_column flex_wrap w_100"><!> <button type="button" title="create a new project" class="w_100 mt_xs justify_content_start"><div class="row white_space_nowrap"><span class="font_size_xl3 mr_lg line_height_1">+</span> create new project</div></button></div></div>'),ga=x('<span class="font_size_xl">🔮</span>'),ba=(o,e)=>z(e,!l(e)),xa=()=>{localStorage.clear(),location.reload()},ya=x('<div><button type="button" class="w_100 color_c selected deselectable"><div class="font_size_xl3">✕</div> <div class="ml_lg text_align_left">permanently delete<br>all locally saved data</div></button></div>'),wa=x('<div class="pane p_xl mb_xl3"><section><!></section> <section><!></section></div> <div class="pane p_xl mb_xl3"><section><!></section> <section><h3>Edit scene</h3> <!></section></div> <div class="pane p_lg mb_xl3"><!></div> <div class="pane p_xl mb_xl3 shadow_c_xl"><h2 class="mt_xl color_c_5 font_weight_600">Danger zone</h2> <section class="width_sm"><!></section> <section><h3 class="mt_xl">Storage</h3> <div><p class="width_sm">Data is saved locally on your computer using <!>.</p>  <div class="width_sm"><button type="button" class="w_100 color_c">clear all saved data</button> <!></div></div></section></div>',1),ja=x('<div class="main_menu svelte-110728v"><div class="sidebar svelte-110728v"><!> <div class="box"><div class="box pane p_xs2"><div class="box p_xl3 gap_xl3 border_radius_sm shadow_md"><!> <nav><ul class="display_flex flex_column gap_sm unstyled"><li><a class="chip w_100 box px_md py_xs">demos</a></li> <li><a class="chip w_100 box px_md py_xs">about</a></li> <li><a class="chip w_100 box p_md pb_xs white_space_nowrap" href="https://github.com/ryanatkn/dealt"><!> source</a></li></ul></nav></div></div></div> <div class="box"><div class="box row pane"><div class="icon_size_lg" title="dealt">🔮</div></div></div></div> <div class="content svelte-110728v"><!></div></div>');function za(o,e){E(e,!0);let a=N(!1);const s=pe.maybe_get(),v=F(()=>s==null?void 0:s.project);Ve(()=>{e.app.show_main_menu&&e.app.close_main_menu()});var p=ue(),m=B(p);{var f=c=>{Oe(c,{get onclose(){return e.app.close_main_menu},layout:"page",children:(n,d)=>{var _=ja(),g=r(_),u=r(g);{var b=I=>{var q=ha(),W=i(r(q),2),K=r(W);je(K,16,()=>s.projects,Q=>Q,(Q,L,oe,ce)=>{var X=pa();const Y=F(()=>s.selected_project_id===L.id);var R=r(X);let Z;R.__click=function(...ee){var re;(re=l(Y)?void 0:()=>{s.select_project(L.id)})==null||re.apply(this,ee)},Pe(R,"",{},{"flex-wrap":"nowrap"});var ae=r(R),_e=r(ae,!0);t(ae);var $=i(ae,2),ge=r($,!0);t($),t(R),t(X),D(ee=>{U(R,"title",l(Y)?`${L.glyph} ${L.name} is selected`:`select project ${L.glyph} ${L.name}`),Z=Me(R,1,"w_100 color_d text_align_left justify_content_start",null,Z,ee),P(_e,L.glyph),P(ge,L.name)},[()=>({selected:l(Y)})]),O(3,X,()=>M),h(Q,X)});var he=i(K,2);he.__click=[fa,s],t(W),t(q),h(I,q)};C(u,I=>{s&&I(b)})}var w=i(u,2),j=r(w),k=r(j),T=r(k);Ct(T,{children:(I,q)=>{var W=ga();h(I,W)},$$slots:{default:!0}});var y=i(T,2),S=r(y),A=r(S),H=r(A);U(H,"href",`${Fe??""}/demo`),t(A);var fe=i(A,2),Ke=r(fe);U(Ke,"href",`${Fe??""}/about`),t(fe);var Ae=i(fe,2),Ce=r(Ae),Qe=r(Ce);We(Qe,{data:Tt,size:"var(--icon_size_md)"}),te(),t(Ce),t(Ae),t(S),t(y),t(k),t(j),t(w),te(2),t(g);var Be=i(g,2),Xe=r(Be);{var Ye=I=>{var q=wa(),W=B(q),K=r(W),he=r(K);Xt(he,{get project(){return l(v)}}),t(K);var Q=i(K,2),L=r(Q);ca(L,{get project(){return l(v)}}),t(Q),t(W);var oe=i(W,2),ce=r(oe),X=r(ce);Ge(X,{get project(){return s.project}}),t(ce);var Y=i(ce,2),R=i(r(Y),2);He(R,{get scene(){return s.project.scene}}),t(Y),t(oe);var Z=i(oe,2),ae=r(Z);qe(ae,{get scene(){return s.project.scene}}),t(Z);var _e=i(Z,2),$=i(r(_e),2),ge=r($);ma(ge,{get project(){return l(v)}}),t($);var ee=i($,2),re=i(r(ee),2),be=r(re),Ze=i(r(be));Jt(Ze,{path:"Web/API/Window/localStorage"}),te(),t(be);var Ee=i(be,2),Je=r(Ee);Je.__click=[ba,a];var $e=i(Je,2);{var et=xe=>{var ve=ya(),tt=r(ve);tt.__pointerup=[xa],t(ve),O(3,ve,()=>M),h(xe,ve)};C($e,xe=>{l(a)&&xe(et)})}t(Ee),t(re),t(ee),t(_e),h(I,q)};C(Xe,I=>{s&&l(v)&&I(Ye)})}t(Be),t(_),h(n,_)},$$slots:{default:!0}})};C(m,c=>{e.app.show_main_menu&&c(f)})}h(o,p),J()}G(["click","pointerup"]);var ka=x('<div class="column width_md gap_xl3 mx_auto"><div class="pane p_lg"><section><!></section> <section><h3>Edit scene</h3> <!></section></div> <div class="pane p_lg"><!></div></div>');function Sa(o,e){E(e,!0);const a=V(e,"editor",7);Ve(()=>{a().show_scene_menu&&(a().show_scene_menu=!1)});var s=ue(),v=B(s);{var p=m=>{Oe(m,{onclose:()=>a().show_scene_menu=!a().show_scene_menu,layout:"page",children:(f,c)=>{var n=ka(),d=r(n),_=r(d),g=r(_);Ge(g,{get project(){return a().project}}),t(_);var u=i(_,2),b=i(r(u),2);He(b,{get scene(){return a().project.scene}}),t(u),t(d);var w=i(d,2),j=r(w);qe(j,{get scene(){return a().project.scene}}),t(w),t(n),h(f,n)},$$slots:{default:!0}})};C(v,m=>{a().show_scene_menu&&m(p)})}h(o,s),J()}var Da=x("<!> <!> <!>",1),Pa=x("<!> <!>",1);function qa(o,e){E(e,!0);const a=new bt(wt,"pixi",300,300),s=ot.set(new ct({renderer:a}));xt.set(s.clock),globalThis.app=s;const v=pe.set(new yt({app:s}));let p=!1;me(()=>{const n=s.json;p?(console.log("[layout] saving app json",n),s.save(n)):(console.log("[layout] initing app json",n),p=!0)});var m=Pa();nt(n=>{lt.title="Dealt: editor"});var f=B(m);_t(f,{});var c=i(f,2);vt(c,{children:(n,d)=>{var _=Da(),g=B(_);Se(g,()=>e.children);var u=i(g,2);za(u,{app:s});var b=i(u,2);Sa(b,{editor:v}),h(n,_)}}),h(o,m),J()}export{qa as component};
