var rt=Object.defineProperty;var Je=o=>{throw TypeError(o)};var st=(o,e,t)=>e in o?rt(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var we=(o,e,t)=>st(o,typeof e!="symbol"?e+"":e,t),lt=(o,e,t)=>e.has(o)||Je("Cannot "+t);var oe=(o,e,t)=>(lt(o,e,"read from private field"),t?t.call(o):e.get(o)),je=(o,e,t)=>e.has(o)?Je("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(o):e.set(o,t);import{a as h,t as x,c as ve,b as de,h as nt}from"../chunks/disclose-version.Ds06f9Vu.js";import{q as A,c as r,K as n,s as l,r as a,m as S,o as B,L as N,v as E,a0 as J,W as z,u as ue,a1 as it,n as Q,$ as ot}from"../chunks/runtime.5k9ShzZt.js";import{s as Se}from"../chunks/snippet.CcawutmI.js";import{a as ct,A as _t,d as vt,D as dt}from"../chunks/Dealt.CbmhkujN.js";import{f as De,X as ut,_ as mt,$ as pt,e as me,a0 as ft,p as Oe,a1 as We,a2 as ht,a3 as gt,j as bt,c as xt,E as yt,R as wt,r as jt}from"../chunks/renderer_components.C9aNiI4a.js";import{s as D,d as X,r as zt}from"../chunks/render.CAjsxhF5.js";import{i as T,c as pe,p as Y}from"../chunks/props.lofZ2jro.js";import{a as Fe,d as kt,f as St,s as I,b as se,e as ze,t as Me,r as re,j as ke}from"../chunks/string.25aLtQ0-.js";import{t as R,s as V}from"../chunks/index.DteDSzYE.js";import{S as Ie,c as Dt,g as Pt}from"../chunks/logos.BWdFsbh_.js";import{b as Le}from"../chunks/paths.QRWhL3mC.js";import{D as Re}from"../chunks/Details.B54xJG-N.js";import{b as qt}from"../chunks/preload-helper.DV2ohNv5.js";import{o as Ve}from"../chunks/entry.DycXts2f.js";import{B as Tt}from"../chunks/Breadcrumb.B-rRTUI7.js";var Et=x('<span class="font_mono"> </span>'),Nt=x("<a><!> <!></a>");function At(o,e){A(e,!0);const t=N(()=>e.path.startsWith("https://")?e.path:`https://developer.mozilla.org/en-US/docs/${kt(e.path,"/")}`),s=N(()=>e.children??St(e.path,"/").split("/").at(-1));var d=Nt();let p;var m=r(d);{var f=v=>{var _=Et(),g=r(_,!0);a(_),S(()=>D(g,n(s))),h(v,_)},c=v=>{var _=ve(),g=E(_);Se(g,()=>n(s)),h(v,_)};T(m,v=>{typeof n(s)=="string"?v(f):v(c,!1)})}var i=l(m,2);Ie(i,{data:Dt,inline:!0,size:"var(--icon_size_xs)",classes:"mx_xs3"}),a(d),S(()=>p=Fe(d,p,{...e.attrs,href:n(t),class:"chip white_space_nowrap"})),h(o,d),B()}var Bt=x('<small class="indicator color_b_5 svelte-fqik3v">copied!</small>'),Ct=x('<small class="indicator color_c_5 svelte-fqik3v">failed</small>'),Jt=x("<button><!><!><!></button>");function Pe(o,e){A(e,!0);let t=J(!1),s=J(!1);const d=async u=>{var y,j;if(e.text!==null){z(t,!1),z(s,!1);try{await navigator.clipboard.writeText(e.text)}catch{z(s,!0),(y=e.onclick)==null||y.call(e,null,u);return}z(t,!0),(j=e.onclick)==null||j.call(e,e.text,u)}};var p=Jt();let m;var f=r(p);{var c=u=>{var y=ve(),j=E(y);Se(j,()=>e.children,()=>n(t),()=>n(s)),h(u,y)},i=u=>{var y=de("📋");h(u,y)};T(f,u=>{e.children?u(c):u(i,!1)})}var v=l(f);{var _=u=>{var y=Bt();h(u,y)};T(v,u=>{n(t)&&u(_)})}var g=l(v);{var b=u=>{var y=Ct();h(u,y)};T(g,u=>{n(s)&&u(b)})}a(p),S(()=>{var u;return m=Fe(p,m,{...e.attrs,type:"button",class:e.classes??(e.children?void 0:"icon_button size_lg"),onclick:d,disabled:((u=e.attrs)==null?void 0:u.disabled)??e.text===null},"svelte-fqik3v")}),h(o,p),B()}var le,_e;class ce{constructor(e,t){je(this,le,J());we(this,"serialize");we(this,"parse");je(this,_e,N(()=>this.serialize(this.value)));this.value=e,this.serialize=(t==null?void 0:t.serialize)??(s=>JSON.stringify(s,null,2)),this.parse=(t==null?void 0:t.parse)??JSON.parse}get value(){return n(oe(this,le))}set value(e){z(oe(this,le),pe(e))}get serialized(){return n(oe(this,_e))}set_from_serialized(e){this.value=this.parse(e)}}le=new WeakMap,_e=new WeakMap;var Lt=x('<p class="color_c_5"><strong> </strong></p>'),Ot=x('<form><div class="flex mb_md gap_md"><button type="button"> </button> <!></div> <textarea></textarea> <!></form>');function Ke(o,e){A(e,!0);const t=Y(e,"parse_error",3,"failed to parse data - is it valid JSON?"),s=Y(e,"title",3,"data"),d=Y(e,"name",3,""),p=N(()=>e.data&&e.data instanceof ce?e.data:new ce(e.data)),m=N(()=>n(p).serialized);let f=J(void 0),c=J(""),i=J(null);const v=()=>{var k,q;if(!n(c)){(k=n(f))==null||k.focus();return}let w;try{w=n(p).parse(n(c))}catch{z(i,t());return}z(i,null),z(c,""),(q=e.onimport)==null||q.call(e,w,n(c))};ue(()=>{n(c),z(i,null)});var _=Ot(),g=r(_),b=r(g);b.__click=v;var u=r(b);a(b);var y=l(b,2);Pe(y,{get text(){return n(m)},onclick:async()=>{var w,k;z(c,pe(n(m))),await it(),(w=n(f))==null||w.select(),(k=n(f))==null||k.focus()},children:(w,k)=>{Q();var q=de();S(()=>D(q,`⧉ copy ${s()??""}`)),h(w,q)},$$slots:{default:!0}}),a(g);var j=l(g,2);zt(j),qt(j,w=>z(f,w),()=>n(f));var P=l(j,2);{var L=w=>{var k=Lt(),q=r(k),G=r(q,!0);a(q),a(k),S(()=>D(G,n(i))),R(3,k,()=>V),h(w,k)};T(P,w=>{n(i)&&w(L)})}a(_),S(()=>{b.disabled=n(c)===n(m),D(u,`↦ import ${s()??""}`),I(j,"placeholder",`${(d()?d()+" ":"")??""}JSON to import`)}),De(j,()=>n(c),w=>z(c,w)),h(o,_),B()}X(["click"]);var Wt=x('<div class="panel relative"><pre class="p_xs mb_0 svelte-1a9oeig"> </pre> <div class="absolute"><!></div></div>'),Ft=x('<h2 class="mt_xl">Scene data</h2> <section><!></section> <!>',1);function Ue(o,e){A(e,!0);const t=N(()=>ut(e.scene)),s=N(()=>new ce(n(t)));var d=Ft(),p=l(E(d),2),m=r(p);Ke(m,{get data(){return n(s)},title:"scene data",name:"Scene",onimport:(c,i)=>{var v;e.scene.reset(c),(v=e.onimport)==null||v.call(e,c,i)}}),a(p);var f=l(p,2);Re(f,{summary:i=>{Q();var v=de("View raw scene data");h(i,v)},children:(i,v)=>{var _=Wt(),g=r(_),b=r(g,!0);a(g);var u=l(g,2);se(u,"right","var(--size_lg)"),se(u,"top","var(--size_lg)");var y=r(u);Pe(y,{get text(){return n(s).serialized}}),a(u),a(_),S(()=>D(b,n(s).serialized)),h(i,_)},$$slots:{summary:!0,default:!0}}),h(o,d),B()}var Mt=(o,e,t)=>{const s=e.create();t.project.create_scene(s)},It=x('<button type="button"><span class="size_xl3 mr_sm"> </span> </button>'),Rt=x('<div><button type="button" class="white_space_nowrap"> </button></div>'),Vt=x('<h3>Load scene</h3> <section class="row gap_md flex_wrap"></section>',1),Kt=x('<h2 class="mt_xl">Scenes</h2> <h3>Create new scene</h3> <section class="row gap_md flex_wrap"></section> <!>',1);function Xe(o,e){A(e,!0);var t=Kt(),s=l(E(t),4);ze(s,20,()=>mt,m=>m,(m,f)=>{var c=It();c.__click=[Mt,f,e];var i=r(c),v=r(i,!0);a(i);var _=l(i);a(c),S(()=>{I(c,"title",`create scene: ${f.name??""}`),D(v,f.glyph),D(_,` ${f.name??""}`)}),h(m,c)}),a(s);var d=l(s,2);{var p=m=>{var f=Vt(),c=l(E(f),2);ze(c,21,()=>e.project.scenes,i=>i.id,(i,v)=>{var _=Rt();const g=N(()=>e.project.selected_scene_id===n(v).id);var b=r(_),u=N(()=>n(g)?void 0:()=>{n(v).load(),e.project.select_scene(n(v).id)});b.__click=function(...j){var P;(P=n(u))==null||P.apply(this,j)};var y=r(b);a(b),a(_),S(()=>{Me(b,"selected",n(g)),D(y,`${n(v).glyph??""}
					${n(v).name??""}`)}),R(3,_,()=>V,()=>({axis:"x"})),h(i,_)}),a(c),h(m,f)};T(d,m=>{e.project.scenes.length&&m(p)})}h(o,t),B()}X(["click"]);var Ut=(o,e,t)=>{const{value:s}=o.currentTarget;z(e,pe(pt(s))),n(e)===null&&(t().glyph=s)},Xt=x('<div><strong class="color_c_5"> </strong></div>'),Gt=x('<header class="row mb_lg size_xl3"><span class="icon_size_lg pr_xl"> </span> </header> <form class="flex flex_column gap_md width_sm"><label><div class="title">name</div> <input placeholder="project name"></label> <label><div class="title">glyph</div> <input placeholder="project glyph"> <!></label></form>',1);function Ht(o,e){A(e,!0);const t=Y(e,"project",7);let s=J(null);var d=Gt(),p=E(d),m=r(p),f=r(m,!0);a(m);var c=l(m);a(p);var i=l(p,2),v=r(i),_=l(r(v),2);re(_),a(v);var g=l(v,2),b=l(r(g),2);re(b),b.__input=[Ut,s,t];var u=l(b,2);{var y=j=>{var P=Xt(),L=r(P),w=r(L,!0);a(L),a(P),S(()=>D(w,n(s))),R(3,P,()=>V),h(j,P)};T(u,j=>{n(s)&&j(y)})}a(g),a(i),S(()=>{D(f,t().glyph),D(c,` ${t().name??""}`),I(_,"title",`project name for ${t().glyph??""}`),ke(b,t().glyph),I(b,"title",`project glyph for ${t().name??""}`)}),De(_,()=>t().name,j=>t().name=j),h(o,d),B()}X(["input"]);var Qt=(o,e)=>z(e,!n(e)),Yt=(o,e,t,s)=>{e.project.delete_scene(t.scene.id),z(s,!1)},Zt=x('<div><button type="button" class="w_100 color_c selected deselectable"><div class="size_xl3">✕</div> <div class="ml_lg text_align_left">permanently delete scene<br> </div></button></div>'),$t=x('<button type="button" class="w_100 color_c">delete scene</button> <!>',1);function ea(o,e){A(e,!0);const t=me.get();let s=J(!1);ue(()=>{e.scene.id,z(s,!1)});var d=$t(),p=E(d);p.__click=[Qt,s];var m=l(p,2);{var f=c=>{var i=Zt(),v=r(i);v.__pointerup=[Yt,t,e,s];var _=l(r(v),2),g=l(r(_),2);a(_),a(v),a(i),S(()=>D(g,`${e.scene.glyph??""}
				${e.scene.name??""}`)),R(3,i,()=>V),h(c,i)};T(m,c=>{n(s)&&c(f)})}h(o,d),B()}X(["click","pointerup"]);var ta=(o,e,t)=>{const{value:s}=o.currentTarget;z(e,pe(ft(s))),n(e)===null&&(t().glyph=s)},aa=x('<div><strong class="color_c_5"> </strong></div>'),ra=(o,e)=>e().save(),sa=(o,e)=>e().project.duplicate_scene(e()),la=x('<form class="flex flex_column gap_md width_sm"><fieldset><label><div class="title">name</div> <input placeholder="scene name" title="scene name"></label> <label><div class="title">glyph</div> <input placeholder="scene glyph"> <!></label> <label><div class="title">id</div> <input disabled title="scene id"></label></fieldset> <fieldset class="gap_md"><button type="button" class="color_a">save scene</button> <button type="button">duplicate scene</button></fieldset> <fieldset><h3 class="color_c_5">Delete scene</h3> <!></fieldset></form>');function Ge(o,e){A(e,!0);const t=Y(e,"scene",7);let s=J(null);var d=la(),p=r(d),m=r(p),f=l(r(m),2);re(f),a(m);var c=l(m,2),i=l(r(c),2);re(i),i.__input=[ta,s,t];var v=l(i,2);{var _=w=>{var k=aa(),q=r(k),G=r(q,!0);a(q),a(k),S(()=>D(G,n(s))),R(3,k,()=>V),h(w,k)};T(v,w=>{n(s)&&w(_)})}a(c);var g=l(c,2),b=l(r(g),2);re(b),a(g),a(p);var u=l(p,2),y=r(u);y.__click=[ra,t];var j=l(y,2);j.__click=[sa,t],a(u);var P=l(u,2),L=l(r(P),2);ea(L,{get scene(){return t()}}),a(P),a(d),S(()=>{ke(i,t().glyph),I(i,"title",`scene glyph for ${t().name??""}`),ke(b,t().id)}),De(f,()=>t().name,w=>t().name=w),h(o,d),B()}X(["input","click"]);var na=x('<div class="panel relative"><pre class="p_xs mb_0 svelte-1a9oeig"> </pre> <div class="absolute"><!></div></div>'),ia=x('<h2 class="mt_xl">Project data</h2> <section><!></section> <!>',1);function oa(o,e){A(e,!0);const t=N(()=>new ce(e.project.json));var s=ia(),d=l(E(s),2),p=r(d);Ke(p,{get data(){return n(t)},title:"project data",name:"Project",onimport:(f,c)=>{var i;e.project.set_json(Oe(f)),(i=e.onimport)==null||i.call(e,f,c)}}),a(d);var m=l(d,2);Re(m,{summary:c=>{Q();var i=de("View raw project data");h(c,i)},children:(c,i)=>{var v=na(),_=r(v),g=r(_,!0);a(_);var b=l(_,2);se(b,"right","var(--size_lg)"),se(b,"top","var(--size_lg)");var u=r(b);Pe(u,{get text(){return n(t).serialized}}),a(b),a(v),S(()=>D(g,n(t).serialized)),h(c,v)},$$slots:{summary:!0,default:!0}}),h(o,s),B()}var ca=(o,e)=>z(e,!n(e)),_a=(o,e,t,s)=>{var d;e.delete_project(t.project.id),z(s,!1),(d=o.currentTarget.closest(".dialog"))==null||d.scrollTo({top:0,behavior:"smooth"})},va=x('<div><button type="button" class="w_100 color_c selected deselectable"><div class="size_xl3">✕</div> <div class="ml_lg text_align_left">permanently delete project<br> </div></button></div>'),da=x('<button type="button" class="w_100 color_c">delete project</button> <!>',1);function ua(o,e){A(e,!0);const t=me.get();let s=J(!1);ue(()=>{e.project.id,z(s,!1)});var d=da(),p=E(d);p.__pointerup=[ca,s];var m=l(p,2);{var f=c=>{var i=va(),v=r(i);v.__pointerup=[_a,t,e,s];var _=l(r(v),2),g=l(r(_),2);a(_),a(v),a(i),S(()=>D(g,`${e.project.glyph??""}
				${e.project.name??""}`)),R(3,i,()=>V),h(c,i)};T(m,c=>{n(s)&&c(f)})}h(o,d),B()}X(["pointerup"]);var ma=x('<div class="w_100 py_xs"><button type="button" class="w_100 color_d text_align_left justify_content_start"><div class="size_xl3 mr_lg"> </div> <div class="ellipsis"> </div></button></div>'),pa=(o,e)=>{e.create_project(Oe({name:ht(e.projects),scenes:[gt(bt())]}))},fa=x('<div class="pane p_lg width_sm"><h2 class="mt_0 mb_lg row pr_md"><span class="icon_size_lg">🏞</span> projects</h2> <div class="flex flex_column flex_wrap w_100"><!> <button type="button" title="create a new project" class="w_100 mt_xs justify_content_start"><div class="row white_space_nowrap"><span class="size_xl3 mr_lg line_height_1">+</span> create new project</div></button></div></div>'),ha=x('<span class="size_xl">🔮</span>'),ga=(o,e)=>z(e,!n(e)),ba=()=>{localStorage.clear(),location.reload()},xa=x('<div><button type="button" class="w_100 color_c selected deselectable"><div class="size_xl3">✕</div> <div class="ml_lg text_align_left">permanently delete<br>all locally saved data</div></button></div>'),ya=x('<div class="pane p_xl mb_xl3"><section><!></section> <section><!></section></div> <div class="pane p_xl mb_xl3"><section><!></section> <section><h3>Edit scene</h3> <!></section></div> <div class="pane p_lg mb_xl3"><!></div> <div class="pane p_xl mb_xl3 shadow_c_xl"><h2 class="mt_xl color_c_5 font_weight_600">Danger zone</h2> <section class="width_sm"><!></section> <section><h3 class="mt_xl">Storage</h3> <div><p class="width_sm">Data is saved locally on your computer using <!>.</p>  <div class="width_sm"><button type="button" class="w_100 color_c">clear all saved data</button> <!></div></div></section></div>',1),wa=x('<div class="main_menu svelte-15asqit"><div class="sidebar gap_xl3 svelte-15asqit"><!> <div class="box"><div class="box pane p_xs2"><div class="box p_xl3 gap_xl3 radius_sm shadow_md"><!> <nav><ul class="flex flex_column gap_sm unstyled"><li><a class="chip w_100 box px_md py_xs">demos</a></li> <li><a class="chip w_100 box px_md py_xs">about</a></li> <li><a class="chip w_100 box p_md pb_xs white_space_nowrap" href="https://github.com/ryanatkn/dealt"><!> source</a></li></ul></nav></div></div></div> <div class="box"><div class="box row pane"><div class="icon_size_lg" title="dealt">🔮</div></div></div></div> <div class="content svelte-15asqit"><!></div></div>');function ja(o,e){A(e,!0);let t=J(!1);const s=me.maybe_get(),d=N(()=>s==null?void 0:s.project);Ve(()=>{e.app.show_main_menu&&e.app.close_main_menu()});var p=ve(),m=E(p);{var f=c=>{We(c,{get onclose(){return e.app.close_main_menu},layout:"page",children:(i,v)=>{var _=wa(),g=r(_),b=r(g);{var u=O=>{var K=fa(),F=l(r(K),2),H=r(F);ze(H,16,()=>s.projects,Z=>Z,(Z,C)=>{var M=ma();const $=N(()=>s.selected_project_id===C.id);var W=r(M),he=N(()=>n($)?void 0:()=>{s.select_project(C.id)});W.__click=function(...be){var ae;(ae=n(he))==null||ae.apply(this,be)};var U=r(W),ge=r(U,!0);a(U);var ee=l(U,2),te=r(ee,!0);a(ee),a(W),a(M),S(()=>{I(W,"title",n($)?`${C.glyph} ${C.name} is selected`:`select project ${C.glyph} ${C.name}`),Me(W,"selected",n($)),se(W,"flex-wrap","nowrap"),D(ge,C.glyph),D(te,C.name)}),R(3,M,()=>V),h(Z,M)});var ne=l(H,2);ne.__click=[pa,s],a(F),a(K),h(O,K)};T(b,O=>{s&&O(u)})}var y=l(b,2),j=r(y),P=r(j),L=r(P);Tt(L,{children:(O,K)=>{var F=ha();h(O,F)},$$slots:{default:!0}});var w=l(L,2),k=r(w),q=r(k),G=r(q);I(G,"href",`${Le??""}/demo`),a(q);var fe=l(q,2),He=r(fe);I(He,"href",`${Le??""}/about`),a(fe);var qe=l(fe,2),Te=r(qe),Qe=r(Te);Ie(Qe,{data:Pt,size:"var(--icon_size_md)"}),Q(),a(Te),a(qe),a(k),a(w),a(P),a(j),a(y),Q(2),a(g);var Ee=l(g,2),Ye=r(Ee);{var Ze=O=>{var K=ya(),F=E(K),H=r(F),Ne=r(H);Ht(Ne,{get project(){return n(d)}}),a(H);var ne=l(H,2),Z=r(ne);oa(Z,{get project(){return n(d)}}),a(ne),a(F);var C=l(F,2),M=r(C),$=r(M);Xe($,{get project(){return s.project}}),a(M);var W=l(M,2),he=l(r(W),2);Ge(he,{get scene(){return s.project.scene}}),a(W),a(C);var U=l(C,2),ge=r(U);Ue(ge,{get scene(){return s.project.scene}}),a(U);var ee=l(U,2),te=l(r(ee),2),be=r(te);ua(be,{get project(){return n(d)}}),a(te);var ae=l(te,2),Ae=l(r(ae),2),xe=r(Ae),$e=l(r(xe));At($e,{path:"Web/API/Window/localStorage"}),Q(),a(xe);var Be=l(xe,2),Ce=r(Be);Ce.__click=[ga,t];var et=l(Ce,2);{var tt=ye=>{var ie=xa(),at=r(ie);at.__pointerup=[ba],a(ie),R(3,ie,()=>V),h(ye,ie)};T(et,ye=>{n(t)&&ye(tt)})}a(Be),a(Ae),a(ae),a(ee),h(O,K)};T(Ye,O=>{s&&n(d)&&O(Ze)})}a(Ee),a(_),h(i,_)},$$slots:{default:!0}})};T(m,c=>{e.app.show_main_menu&&c(f)})}h(o,p),B()}X(["click","pointerup"]);var za=x('<div class="scene_menu width_md svelte-1rvxfq4"><div class="pane p_xl mb_xl3"><section><!></section> <section><h3>Edit scene</h3> <!></section></div> <div class="pane p_lg mb_xl3 width_md"><!></div></div>');function ka(o,e){A(e,!0);const t=Y(e,"editor",7);Ve(()=>{t().show_scene_menu&&(t().show_scene_menu=!1)});var s=ve(),d=E(s);{var p=m=>{We(m,{onclose:()=>t().show_scene_menu=!t().show_scene_menu,layout:"page",children:(f,c)=>{var i=za(),v=r(i),_=r(v),g=r(_);Xe(g,{get project(){return t().project}}),a(_);var b=l(_,2),u=l(r(b),2);Ge(u,{get scene(){return t().project.scene}}),a(b),a(v);var y=l(v,2),j=r(y);Ue(j,{get scene(){return t().project.scene}}),a(y),a(i),h(f,i)},$$slots:{default:!0}})};T(d,m=>{t().show_scene_menu&&m(p)})}h(o,s),B()}var Sa=x("<!> <!> <!>",1),Da=x("<!> <!>",1);function Va(o,e){A(e,!0);const t=new wt(jt,"pixi",300,300),s=ct.set(new _t({renderer:t}));xt.set(s.clock),globalThis.app=s;const d=me.set(new yt({app:s}));let p=!1;ue(()=>{const i=s.json;p?(console.log("[layout] saving app json",i),s.save(i)):(console.log("[layout] initing app json",i),p=!0)});var m=Da();nt(i=>{ot.title="Dealt: editor"});var f=E(m);vt(f,{});var c=l(f,2);dt(c,{children:(i,v)=>{var _=Sa(),g=E(_);Se(g,()=>e.children);var b=l(g,2);ja(b,{app:s});var u=l(b,2);ka(u,{editor:d}),h(i,_)},$$slots:{default:!0}}),h(o,m),B()}export{Va as component};
