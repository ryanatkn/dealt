var at=Object.defineProperty;var Je=o=>{throw TypeError(o)};var rt=(o,e,a)=>e in o?at(o,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):o[e]=a;var ye=(o,e,a)=>rt(o,typeof e!="symbol"?e+"":e,a),st=(o,e,a)=>e.has(o)||Je("Cannot "+a);var se=(o,e,a)=>(st(o,e,"read from private field"),a?a.call(o):e.get(o)),we=(o,e,a)=>e.has(o)?Je("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(o):e.set(o,a);import{t as x,a as h,c as ue,b as ke,h as it}from"../chunks/DyCZ_lw9.js";import{m as B,c as r,w as n,x as N,s as l,r as t,o as D,q as E,v as q,ai as J,X as z,u as me,n as te,aj as lt,$ as nt}from"../chunks/Dkaln31E.js";import{s as Se}from"../chunks/DQXgQxX-.js";import{a as ot,A as ct,d as _t,D as vt}from"../chunks/BrtYs_i3.js";import{g as De,y as dt,z as ut,A as mt,e as pe,B as pt,p as Fe,F as Le,I as ft,J as ht,j as gt,R as bt,c as xt,E as yt,r as wt}from"../chunks/BERuEieG.js";import{s as P,d as X,r as jt}from"../chunks/DMs3BEDJ.js";import{i as C,p as R}from"../chunks/Cr-AO5Xh.js";import{a as Oe,d as zt,f as kt,C as St,s as V,g as Pe,b as je,c as Ie,r as ie,i as ze}from"../chunks/C07ZAADA.js";import{t as L,a as Dt,s as I}from"../chunks/CD3rAWNL.js";import{S as Me,c as Pt,g as Tt}from"../chunks/CzNxE-Hc.js";import{b as Ne}from"../chunks/D9bF4BR6.js";import{D as We}from"../chunks/DEVJcBWf.js";import{b as At}from"../chunks/DlVdBben.js";import{o as Re}from"../chunks/D7mdORGl.js";import{B as Ct}from"../chunks/BwrnnQHH.js";var qt=x('<span class="font_mono"> </span>'),Bt=x("<a><!> <!></a>");function Et(o,e){B(e,!0);const a=N(()=>e.path.startsWith("https://")?e.path:`https://developer.mozilla.org/en-US/docs/${zt(e.path,"/")}`),s=N(()=>e.children??kt(e.path,"/").split("/").at(-1));var v=Bt();let p;var m=r(v);{var f=d=>{var _=qt(),g=r(_,!0);t(_),D(()=>P(g,n(s))),h(d,_)},c=d=>{var _=ue(),g=q(_);Se(g,()=>n(s)),h(d,_)};C(m,d=>{typeof n(s)=="string"?d(f):d(c,!1)})}var i=l(m,2);Me(i,{data:Pt,inline:!0,size:"var(--icon_size_xs)",attrs:{class:"mx_xs3"}}),t(v),D(()=>p=Oe(v,p,{...e.attrs,href:n(a),class:"chip white_space_nowrap"})),h(o,v),E()}var Jt=x("<div>✓</div>"),Nt=x("<div>⧉</div>"),Ft=x("<button><!></button>");function Te(o,e){B(e,!0);const a=R(e,"copied_display_duration",3,1e3),s=R(e,"icon_button",3,!0);let v=J(!1),p=J(!1),m;const f=async u=>{var b;if(clearTimeout(m),e.text!==null){z(v,!1),z(p,!1);try{await navigator.clipboard.writeText(e.text),z(v,!0)}catch{z(p,!0);return}m=setTimeout(()=>{z(v,!1)},a()),(b=e.oncopy)==null||b.call(e,e.text,u)}};var c=Ft();let i;var d=r(c);{var _=u=>{var b=ue(),w=q(b);Se(w,()=>e.children,()=>n(v),()=>n(p)),h(u,b)},g=(u,b)=>{{var w=k=>{var T=Jt();L(1,T,()=>Dt,()=>({duration:200})),h(k,T)},j=k=>{var T=Nt();L(1,T,()=>I),h(k,T)};C(u,k=>{n(v)?k(w):k(j,!1)},b)}};C(d,u=>{e.children?u(_):u(g,!1)})}t(c),D(u=>{var b,w;return i=Oe(c,i,{type:"button",title:"copy to clipboard",...e.attrs,class:(b=e.attrs)==null?void 0:b.class,onclick:f,disabled:((w=e.attrs)==null?void 0:w.disabled)??(e.allow_copying_empty_string?e.text===null:!e.text),[St]:u})},[()=>({icon_button:e.children?!1:s(),copied:n(v),failed:n(p),color_c:n(p)})]),h(o,c),E()}var le,ne;class de{constructor(e,a){we(this,le,J());ye(this,"serialize");ye(this,"parse");we(this,ne,N(()=>this.serialize(this.value)));this.value=e,this.serialize=(a==null?void 0:a.serialize)??(s=>JSON.stringify(s,null,2)),this.parse=(a==null?void 0:a.parse)??JSON.parse}get value(){return n(se(this,le))}set value(e){z(se(this,le),e,!0)}get serialized(){return n(se(this,ne))}set serialized(e){z(se(this,ne),e)}set_from_serialized(e){this.value=this.parse(e)}}le=new WeakMap,ne=new WeakMap;var Lt=x('<p class="color_c_5"><strong> </strong></p>'),Ot=x('<form><div class="flex mb_md gap_md"><button type="button"> </button> <!></div> <textarea></textarea> <!></form>');function Ve(o,e){B(e,!0);const a=R(e,"parse_error",3,"failed to parse data - is it valid JSON?"),s=R(e,"title",3,"data"),v=R(e,"name",3,""),p=N(()=>e.data&&e.data instanceof de?e.data:new de(e.data)),m=N(()=>n(p).serialized);let f=J(void 0),c=J(""),i=J(null);const d=()=>{var S,A;if(!n(c)){(S=n(f))==null||S.focus();return}let y;try{y=n(p).parse(n(c))}catch{z(i,a());return}z(i,null),z(c,""),(A=e.onimport)==null||A.call(e,y,n(c))};me(()=>{n(c),z(i,null)});var _=Ot(),g=r(_),u=r(g);u.__click=d;var b=r(u);t(u);var w=l(u,2);Te(w,{get text(){return n(m)},oncopy:async()=>{var y,S;z(c,n(m),!0),await lt(),(y=n(f))==null||y.select(),(S=n(f))==null||S.focus()},children:(y,S)=>{te();var A=ke();D(()=>P(A,`⧉ copy ${s()??""}`)),h(y,A)},$$slots:{default:!0}}),t(g);var j=l(g,2);jt(j),At(j,y=>z(f,y),()=>n(f));var k=l(j,2);{var T=y=>{var S=Lt(),A=r(S),G=r(A,!0);t(A),t(S),D(()=>P(G,n(i))),L(3,S,()=>I),h(y,S)};C(k,y=>{n(i)&&y(T)})}t(_),D(()=>{u.disabled=n(c)===n(m),P(b,`↦ import ${s()??""}`),V(j,"placeholder",`${(v()?v()+" ":"")??""}JSON to import`)}),De(j,()=>n(c),y=>z(c,y)),h(o,_),E()}X(["click"]);var It=x('<div class="panel relative"><pre class="p_xs mb_0 svelte-1a9oeig"> </pre> <div class="absolute"><!></div></div>'),Mt=x('<h2 class="mt_xl">Scene data</h2> <section><!></section> <!>',1);function Ue(o,e){B(e,!0);const a=N(()=>dt(e.scene)),s=N(()=>new de(n(a)));var v=Mt(),p=l(q(v),2),m=r(p);Ve(m,{get data(){return n(s)},title:"scene data",name:"Scene",onimport:(c,i)=>{var d;e.scene.reset(c),(d=e.onimport)==null||d.call(e,c,i)}}),t(p);var f=l(p,2);We(f,{summary:i=>{te();var d=ke("View raw scene data");h(i,d)},children:(i,d)=>{var _=It(),g=r(_),u=r(g,!0);t(g);var b=l(g,2);Pe(b,"",{},{right:"var(--size_lg)",top:"var(--size_lg)"});var w=r(b);Te(w,{get text(){return n(s).serialized}}),t(b),t(_),D(()=>P(u,n(s).serialized)),h(i,_)},$$slots:{summary:!0,default:!0}}),h(o,v),E()}var Wt=(o,e,a)=>{const s=e.create();a.project.create_scene(s)},Rt=x('<button type="button"><span class="size_xl3 mr_sm"> </span> </button>'),Vt=x('<div><button type="button"> </button></div>'),Ut=x('<h3>Load scene</h3> <section class="row gap_md flex_wrap"></section>',1),Xt=x('<h2 class="mt_xl">Scenes</h2> <h3>Create new scene</h3> <section class="row gap_md flex_wrap"></section> <!>',1);function Xe(o,e){B(e,!0);var a=Xt(),s=l(q(a),4);je(s,20,()=>ut,m=>m,(m,f)=>{var c=Rt();c.__click=[Wt,f,e];var i=r(c),d=r(i,!0);t(i);var _=l(i);t(c),D(()=>{V(c,"title",`create scene: ${f.name??""}`),P(d,f.glyph),P(_,` ${f.name??""}`)}),h(m,c)}),t(s);var v=l(s,2);{var p=m=>{var f=Ut(),c=l(q(f),2);je(c,21,()=>e.project.scenes,i=>i.id,(i,d)=>{var _=Vt();const g=N(()=>e.project.selected_scene_id===n(d).id);var u=r(_);let b;u.__click=function(...j){var k;(k=n(g)?void 0:()=>{n(d).load(),e.project.select_scene(n(d).id)})==null||k.apply(this,j)};var w=r(u);t(u),t(_),D(j=>{b=Ie(u,1,"white_space_nowrap",null,b,j),P(w,`${n(d).glyph??""}
					${n(d).name??""}`)},[()=>({selected:n(g)})]),L(3,_,()=>I,()=>({axis:"x"})),h(i,_)}),t(c),h(m,f)};C(v,m=>{e.project.scenes.length&&m(p)})}h(o,a),E()}X(["click"]);var Gt=(o,e,a)=>{const{value:s}=o.currentTarget;z(e,mt(s),!0),n(e)===null&&(a().glyph=s)},Ht=x('<div><strong class="color_c_5"> </strong></div>'),Kt=x('<header class="row mb_lg size_xl3"><span class="icon_size_lg pr_xl"> </span> </header> <form class="flex flex_column gap_md width_sm"><label><div class="title">name</div> <input placeholder="project name"></label> <label><div class="title">glyph</div> <input placeholder="project glyph"> <!></label></form>',1);function Qt(o,e){B(e,!0);const a=R(e,"project",7);let s=J(null);var v=Kt(),p=q(v),m=r(p),f=r(m,!0);t(m);var c=l(m);t(p);var i=l(p,2),d=r(i),_=l(r(d),2);ie(_),t(d);var g=l(d,2),u=l(r(g),2);ie(u),u.__input=[Gt,s,a];var b=l(u,2);{var w=j=>{var k=Ht(),T=r(k),y=r(T,!0);t(T),t(k),D(()=>P(y,n(s))),L(3,k,()=>I),h(j,k)};C(b,j=>{n(s)&&j(w)})}t(g),t(i),D(()=>{P(f,a().glyph),P(c,` ${a().name??""}`),V(_,"title",`project name for ${a().glyph??""}`),ze(u,a().glyph),V(u,"title",`project glyph for ${a().name??""}`)}),De(_,()=>a().name,j=>a().name=j),h(o,v),E()}X(["input"]);var Yt=(o,e)=>z(e,!n(e)),Zt=(o,e,a,s)=>{e.project.delete_scene(a.scene.id),z(s,!1)},$t=x('<div><button type="button" class="w_100 color_c selected deselectable"><div class="size_xl3">✕</div> <div class="ml_lg text_align_left">permanently delete scene<br> </div></button></div>'),ea=x('<button type="button" class="w_100 color_c">delete scene</button> <!>',1);function ta(o,e){B(e,!0);const a=pe.get();let s=J(!1);me(()=>{e.scene.id,z(s,!1)});var v=ea(),p=q(v);p.__click=[Yt,s];var m=l(p,2);{var f=c=>{var i=$t(),d=r(i);d.__pointerup=[Zt,a,e,s];var _=l(r(d),2),g=l(r(_),2);t(_),t(d),t(i),D(()=>P(g,`${e.scene.glyph??""}
				${e.scene.name??""}`)),L(3,i,()=>I),h(c,i)};C(m,c=>{n(s)&&c(f)})}h(o,v),E()}X(["click","pointerup"]);var aa=(o,e,a)=>{const{value:s}=o.currentTarget;z(e,pt(s),!0),n(e)===null&&(a().glyph=s)},ra=x('<div><strong class="color_c_5"> </strong></div>'),sa=(o,e)=>e().save(),ia=(o,e)=>e().project.duplicate_scene(e()),la=x('<form class="flex flex_column gap_md width_sm"><fieldset><label><div class="title">name</div> <input placeholder="scene name" title="scene name"></label> <label><div class="title">glyph</div> <input placeholder="scene glyph"> <!></label> <label><div class="title">id</div> <input disabled title="scene id"></label></fieldset> <fieldset class="gap_md"><button type="button" class="color_a">save scene</button> <button type="button">duplicate scene</button></fieldset> <fieldset><h3 class="color_c_5">Delete scene</h3> <!></fieldset></form>');function Ge(o,e){B(e,!0);const a=R(e,"scene",7);let s=J(null);var v=la(),p=r(v),m=r(p),f=l(r(m),2);ie(f),t(m);var c=l(m,2),i=l(r(c),2);ie(i),i.__input=[aa,s,a];var d=l(i,2);{var _=y=>{var S=ra(),A=r(S),G=r(A,!0);t(A),t(S),D(()=>P(G,n(s))),L(3,S,()=>I),h(y,S)};C(d,y=>{n(s)&&y(_)})}t(c);var g=l(c,2),u=l(r(g),2);ie(u),t(g),t(p);var b=l(p,2),w=r(b);w.__click=[sa,a];var j=l(w,2);j.__click=[ia,a],t(b);var k=l(b,2),T=l(r(k),2);ta(T,{get scene(){return a()}}),t(k),t(v),D(()=>{ze(i,a().glyph),V(i,"title",`scene glyph for ${a().name??""}`),ze(u,a().id)}),De(f,()=>a().name,y=>a().name=y),h(o,v),E()}X(["input","click"]);var na=x('<div class="panel relative"><pre class="p_xs mb_0 svelte-1a9oeig"> </pre> <div class="absolute"><!></div></div>'),oa=x('<h2 class="mt_xl">Project data</h2> <section><!></section> <!>',1);function ca(o,e){B(e,!0);const a=N(()=>new de(e.project.json));var s=oa(),v=l(q(s),2),p=r(v);Ve(p,{get data(){return n(a)},title:"project data",name:"Project",onimport:(f,c)=>{var i;e.project.set_json(Fe(f)),(i=e.onimport)==null||i.call(e,f,c)}}),t(v);var m=l(v,2);We(m,{summary:c=>{te();var i=ke("View raw project data");h(c,i)},children:(c,i)=>{var d=na(),_=r(d),g=r(_,!0);t(_);var u=l(_,2);Pe(u,"",{},{right:"var(--size_lg)",top:"var(--size_lg)"});var b=r(u);Te(b,{get text(){return n(a).serialized}}),t(u),t(d),D(()=>P(g,n(a).serialized)),h(c,d)},$$slots:{summary:!0,default:!0}}),h(o,s),E()}var _a=(o,e)=>z(e,!n(e)),va=(o,e,a,s)=>{var v;e.delete_project(a.project.id),z(s,!1),(v=o.currentTarget.closest(".dialog"))==null||v.scrollTo({top:0,behavior:"smooth"})},da=x('<div><button type="button" class="w_100 color_c selected deselectable"><div class="size_xl3">✕</div> <div class="ml_lg text_align_left">permanently delete project<br> </div></button></div>'),ua=x('<button type="button" class="w_100 color_c">delete project</button> <!>',1);function ma(o,e){B(e,!0);const a=pe.get();let s=J(!1);me(()=>{e.project.id,z(s,!1)});var v=ua(),p=q(v);p.__pointerup=[_a,s];var m=l(p,2);{var f=c=>{var i=da(),d=r(i);d.__pointerup=[va,a,e,s];var _=l(r(d),2),g=l(r(_),2);t(_),t(d),t(i),D(()=>P(g,`${e.project.glyph??""}
				${e.project.name??""}`)),L(3,i,()=>I),h(c,i)};C(m,c=>{n(s)&&c(f)})}h(o,v),E()}X(["pointerup"]);var pa=x('<div class="w_100 py_xs"><button type="button"><div class="size_xl3 mr_lg"> </div> <div class="ellipsis"> </div></button></div>'),fa=(o,e)=>{e.create_project(Fe({name:ht(e.projects),scenes:[ft(gt())]}))},ha=x('<div class="pane p_lg width_sm"><h2 class="mt_0 mb_lg row pr_md"><span class="icon_size_lg">🏞</span> projects</h2> <div class="flex flex_column flex_wrap w_100"><!> <button type="button" title="create a new project" class="w_100 mt_xs justify_content_start"><div class="row white_space_nowrap"><span class="size_xl3 mr_lg line_height_1">+</span> create new project</div></button></div></div>'),ga=x('<span class="size_xl">🔮</span>'),ba=(o,e)=>z(e,!n(e)),xa=()=>{localStorage.clear(),location.reload()},ya=x('<div><button type="button" class="w_100 color_c selected deselectable"><div class="size_xl3">✕</div> <div class="ml_lg text_align_left">permanently delete<br>all locally saved data</div></button></div>'),wa=x('<div class="pane p_xl mb_xl3"><section><!></section> <section><!></section></div> <div class="pane p_xl mb_xl3"><section><!></section> <section><h3>Edit scene</h3> <!></section></div> <div class="pane p_lg mb_xl3"><!></div> <div class="pane p_xl mb_xl3 shadow_c_xl"><h2 class="mt_xl color_c_5 font_weight_600">Danger zone</h2> <section class="width_sm"><!></section> <section><h3 class="mt_xl">Storage</h3> <div><p class="width_sm">Data is saved locally on your computer using <!>.</p>  <div class="width_sm"><button type="button" class="w_100 color_c">clear all saved data</button> <!></div></div></section></div>',1),ja=x('<div class="main_menu svelte-15asqit"><div class="sidebar gap_xl3 svelte-15asqit"><!> <div class="box"><div class="box pane p_xs2"><div class="box p_xl3 gap_xl3 radius_sm shadow_md"><!> <nav><ul class="flex flex_column gap_sm unstyled"><li><a class="chip w_100 box px_md py_xs">demos</a></li> <li><a class="chip w_100 box px_md py_xs">about</a></li> <li><a class="chip w_100 box p_md pb_xs white_space_nowrap" href="https://github.com/ryanatkn/dealt"><!> source</a></li></ul></nav></div></div></div> <div class="box"><div class="box row pane"><div class="icon_size_lg" title="dealt">🔮</div></div></div></div> <div class="content svelte-15asqit"><!></div></div>');function za(o,e){B(e,!0);let a=J(!1);const s=pe.maybe_get(),v=N(()=>s==null?void 0:s.project);Re(()=>{e.app.show_main_menu&&e.app.close_main_menu()});var p=ue(),m=q(p);{var f=c=>{Le(c,{get onclose(){return e.app.close_main_menu},layout:"page",children:(i,d)=>{var _=ja(),g=r(_),u=r(g);{var b=O=>{var U=ha(),M=l(r(U),2),H=r(M);je(H,16,()=>s.projects,K=>K,(K,F,oe,ce)=>{var Q=pa();const Y=N(()=>s.selected_project_id===F.id);var W=r(Q);let Z;W.__click=function(...ee){var re;(re=n(Y)?void 0:()=>{s.select_project(F.id)})==null||re.apply(this,ee)},Pe(W,"",{},{"flex-wrap":"nowrap"});var ae=r(W),_e=r(ae,!0);t(ae);var $=l(ae,2),ge=r($,!0);t($),t(W),t(Q),D(ee=>{V(W,"title",n(Y)?`${F.glyph} ${F.name} is selected`:`select project ${F.glyph} ${F.name}`),Z=Ie(W,1,"w_100 color_d text_align_left justify_content_start",null,Z,ee),P(_e,F.glyph),P(ge,F.name)},[()=>({selected:n(Y)})]),L(3,Q,()=>I),h(K,Q)});var he=l(H,2);he.__click=[fa,s],t(M),t(U),h(O,U)};C(u,O=>{s&&O(b)})}var w=l(u,2),j=r(w),k=r(j),T=r(k);Ct(T,{children:(O,U)=>{var M=ga();h(O,M)},$$slots:{default:!0}});var y=l(T,2),S=r(y),A=r(S),G=r(A);V(G,"href",`${Ne??""}/demo`),t(A);var fe=l(A,2),He=r(fe);V(He,"href",`${Ne??""}/about`),t(fe);var Ae=l(fe,2),Ce=r(Ae),Ke=r(Ce);Me(Ke,{data:Tt,size:"var(--icon_size_md)"}),te(),t(Ce),t(Ae),t(S),t(y),t(k),t(j),t(w),te(2),t(g);var qe=l(g,2),Qe=r(qe);{var Ye=O=>{var U=wa(),M=q(U),H=r(M),he=r(H);Qt(he,{get project(){return n(v)}}),t(H);var K=l(H,2),F=r(K);ca(F,{get project(){return n(v)}}),t(K),t(M);var oe=l(M,2),ce=r(oe),Q=r(ce);Xe(Q,{get project(){return s.project}}),t(ce);var Y=l(ce,2),W=l(r(Y),2);Ge(W,{get scene(){return s.project.scene}}),t(Y),t(oe);var Z=l(oe,2),ae=r(Z);Ue(ae,{get scene(){return s.project.scene}}),t(Z);var _e=l(Z,2),$=l(r(_e),2),ge=r($);ma(ge,{get project(){return n(v)}}),t($);var ee=l($,2),re=l(r(ee),2),be=r(re),Ze=l(r(be));Et(Ze,{path:"Web/API/Window/localStorage"}),te(),t(be);var Be=l(be,2),Ee=r(Be);Ee.__click=[ba,a];var $e=l(Ee,2);{var et=xe=>{var ve=ya(),tt=r(ve);tt.__pointerup=[xa],t(ve),L(3,ve,()=>I),h(xe,ve)};C($e,xe=>{n(a)&&xe(et)})}t(Be),t(re),t(ee),t(_e),h(O,U)};C(Qe,O=>{s&&n(v)&&O(Ye)})}t(qe),t(_),h(i,_)},$$slots:{default:!0}})};C(m,c=>{e.app.show_main_menu&&c(f)})}h(o,p),E()}X(["click","pointerup"]);var ka=x('<div class="scene_menu width_md svelte-1rvxfq4"><div class="pane p_xl mb_xl3"><section><!></section> <section><h3>Edit scene</h3> <!></section></div> <div class="pane p_lg mb_xl3 width_md"><!></div></div>');function Sa(o,e){B(e,!0);const a=R(e,"editor",7);Re(()=>{a().show_scene_menu&&(a().show_scene_menu=!1)});var s=ue(),v=q(s);{var p=m=>{Le(m,{onclose:()=>a().show_scene_menu=!a().show_scene_menu,layout:"page",children:(f,c)=>{var i=ka(),d=r(i),_=r(d),g=r(_);Xe(g,{get project(){return a().project}}),t(_);var u=l(_,2),b=l(r(u),2);Ge(b,{get scene(){return a().project.scene}}),t(u),t(d);var w=l(d,2),j=r(w);Ue(j,{get scene(){return a().project.scene}}),t(w),t(i),h(f,i)},$$slots:{default:!0}})};C(v,m=>{a().show_scene_menu&&m(p)})}h(o,s),E()}var Da=x("<!> <!> <!>",1),Pa=x("<!> <!>",1);function Ua(o,e){B(e,!0);const a=new bt(wt,"pixi",300,300),s=ot.set(new ct({renderer:a}));xt.set(s.clock),globalThis.app=s;const v=pe.set(new yt({app:s}));let p=!1;me(()=>{const i=s.json;p?(console.log("[layout] saving app json",i),s.save(i)):(console.log("[layout] initing app json",i),p=!0)});var m=Pa();it(i=>{nt.title="Dealt: editor"});var f=q(m);_t(f,{});var c=l(f,2);vt(c,{children:(i,d)=>{var _=Da(),g=q(_);Se(g,()=>e.children);var u=l(g,2);za(u,{app:s});var b=l(u,2);Sa(b,{editor:v}),h(i,_)}}),h(o,m),E()}export{Ua as component};
