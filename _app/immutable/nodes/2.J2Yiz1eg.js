var at=Object.defineProperty;var Ne=o=>{throw TypeError(o)};var rt=(o,e,a)=>e in o?at(o,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):o[e]=a;var ye=(o,e,a)=>rt(o,typeof e!="symbol"?e+"":e,a),st=(o,e,a)=>e.has(o)||Ne("Cannot "+a);var se=(o,e,a)=>(st(o,e,"read from private field"),a?a.call(o):e.get(o)),we=(o,e,a)=>e.has(o)?Ne("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(o):e.set(o,a);import{t as x,a as h,c as ue,b as ke,h as nt}from"../chunks/DyCZ_lw9.js";import{m as E,c as r,w as i,x as F,s as l,r as t,o as D,q as J,v as B,ai as N,X as z,u as me,n as te,aj as lt,$ as it}from"../chunks/Dkaln31E.js";import{s as Se}from"../chunks/DQXgQxX-.js";import{a as ot,A as ct,d as _t,D as vt}from"../chunks/BrtYs_i3.js";import{g as De,y as dt,z as ut,A as mt,e as pe,B as pt,p as Le,F as Oe,I as ft,J as ht,j as gt,R as bt,c as xt,E as yt,r as wt}from"../chunks/BERuEieG.js";import{s as P,d as X,r as jt}from"../chunks/DMs3BEDJ.js";import{i as C,p as V}from"../chunks/Cr-AO5Xh.js";import{a as Ie,d as zt,f as kt,C as St,s as q,g as Pe,b as je,c as Me,r as ne,i as ze}from"../chunks/C07ZAADA.js";import{t as O,a as Dt,s as M}from"../chunks/CD3rAWNL.js";import{S as We,c as Pt,g as Tt}from"../chunks/CzNxE-Hc.js";import{b as Fe}from"../chunks/B1fI4ZJX.js";import{D as Re}from"../chunks/DEVJcBWf.js";import{b as At}from"../chunks/DlVdBben.js";import{o as Ve}from"../chunks/OdPbT79p.js";import{B as Ct}from"../chunks/CRDS5-xy.js";var Bt=x('<span class="font_mono"> </span>'),Et=x("<a><!> <!></a>");function Jt(o,e){E(e,!0);const a=F(()=>e.path.startsWith("https://")?e.path:`https://developer.mozilla.org/en-US/docs/${zt(e.path,"/")}`),s=F(()=>e.children??kt(e.path,"/").split("/").at(-1));var v=Et();let p;var m=r(v);{var f=d=>{var _=Bt(),g=r(_,!0);t(_),D(()=>P(g,i(s))),h(d,_)},c=d=>{var _=ue(),g=B(_);Se(g,()=>i(s)),h(d,_)};C(m,d=>{typeof i(s)=="string"?d(f):d(c,!1)})}var n=l(m,2);We(n,{data:Pt,inline:!0,size:"var(--icon_size_xs)",attrs:{class:"mx_xs3"}}),t(v),D(()=>p=Ie(v,p,{...e.attrs,href:i(a),class:"chip white_space_nowrap"})),h(o,v),J()}var Nt=x("<div>✓</div>"),Ft=x("<div>⧉</div>"),Lt=x("<button><!></button>");function Te(o,e){E(e,!0);const a=V(e,"copied_display_duration",3,1e3),s=V(e,"icon_button",3,!0);let v=N(!1),p=N(!1),m;const f=async u=>{var b;if(clearTimeout(m),e.text!==null){z(v,!1),z(p,!1);try{await navigator.clipboard.writeText(e.text),z(v,!0)}catch{z(p,!0);return}m=setTimeout(()=>{z(v,!1)},a()),(b=e.oncopy)==null||b.call(e,e.text,u)}};var c=Lt();let n;var d=r(c);{var _=u=>{var b=ue(),w=B(b);Se(w,()=>e.children,()=>i(v),()=>i(p)),h(u,b)},g=(u,b)=>{{var w=k=>{var T=Nt();O(1,T,()=>Dt,()=>({duration:200})),h(k,T)},j=k=>{var T=Ft();O(1,T,()=>M),h(k,T)};C(u,k=>{i(v)?k(w):k(j,!1)},b)}};C(d,u=>{e.children?u(_):u(g,!1)})}t(c),D(u=>{var b,w;return n=Ie(c,n,{type:"button",title:"copy to clipboard",...e.attrs,class:(b=e.attrs)==null?void 0:b.class,onclick:f,disabled:((w=e.attrs)==null?void 0:w.disabled)??(e.allow_copying_empty_string?e.text===null:!e.text),[St]:u})},[()=>({icon_button:e.children?!1:s(),copied:i(v),failed:i(p),color_c:i(p)})]),h(o,c),J()}var le,ie;class de{constructor(e,a){we(this,le,N());ye(this,"serialize");ye(this,"parse");we(this,ie,F(()=>this.serialize(this.value)));this.value=e,this.serialize=(a==null?void 0:a.serialize)??(s=>JSON.stringify(s,null,2)),this.parse=(a==null?void 0:a.parse)??JSON.parse}get value(){return i(se(this,le))}set value(e){z(se(this,le),e,!0)}get serialized(){return i(se(this,ie))}set serialized(e){z(se(this,ie),e)}set_from_serialized(e){this.value=this.parse(e)}}le=new WeakMap,ie=new WeakMap;var Ot=x('<p class="color_c_5"><strong> </strong></p>'),It=x('<form><div class="flex mb_md gap_md"><button type="button"> </button> <!></div> <textarea></textarea> <!></form>');function qe(o,e){E(e,!0);const a=V(e,"parse_error",3,"failed to parse data - is it valid JSON?"),s=V(e,"title",3,"data"),v=V(e,"name",3,""),p=F(()=>e.data&&e.data instanceof de?e.data:new de(e.data)),m=F(()=>i(p).serialized);let f=N(void 0),c=N(""),n=N(null);const d=()=>{var S,A;if(!i(c)){(S=i(f))==null||S.focus();return}let y;try{y=i(p).parse(i(c))}catch{z(n,a());return}z(n,null),z(c,""),(A=e.onimport)==null||A.call(e,y,i(c))};me(()=>{i(c),z(n,null)});var _=It(),g=r(_),u=r(g);u.__click=d;var b=r(u);t(u);var w=l(u,2);Te(w,{get text(){return i(m)},oncopy:async()=>{var y,S;z(c,i(m),!0),await lt(),(y=i(f))==null||y.select(),(S=i(f))==null||S.focus()},children:(y,S)=>{te();var A=ke();D(()=>P(A,`⧉ copy ${s()??""}`)),h(y,A)},$$slots:{default:!0}}),t(g);var j=l(g,2);jt(j),At(j,y=>z(f,y),()=>i(f));var k=l(j,2);{var T=y=>{var S=Ot(),A=r(S),G=r(A,!0);t(A),t(S),D(()=>P(G,i(n))),O(3,S,()=>M),h(y,S)};C(k,y=>{i(n)&&y(T)})}t(_),D(()=>{u.disabled=i(c)===i(m),P(b,`↦ import ${s()??""}`),q(j,"placeholder",`${v()?v()+" ":""}JSON to import`)}),De(j,()=>i(c),y=>z(c,y)),h(o,_),J()}X(["click"]);var Mt=x('<div class="panel relative"><pre class="p_xs mb_0 svelte-1a9oeig"> </pre> <div class="absolute"><!></div></div>'),Wt=x('<h2 class="mt_xl">Scene data</h2> <section><!></section> <!>',1);function Ue(o,e){E(e,!0);const a=F(()=>dt(e.scene)),s=F(()=>new de(i(a)));var v=Wt(),p=l(B(v),2),m=r(p);qe(m,{get data(){return i(s)},title:"scene data",name:"Scene",onimport:(c,n)=>{var d;e.scene.reset(c),(d=e.onimport)==null||d.call(e,c,n)}}),t(p);var f=l(p,2);Re(f,{summary:n=>{te();var d=ke("View raw scene data");h(n,d)},children:(n,d)=>{var _=Mt(),g=r(_),u=r(g,!0);t(g);var b=l(g,2);Pe(b,"",{},{right:"var(--size_lg)",top:"var(--size_lg)"});var w=r(b);Te(w,{get text(){return i(s).serialized}}),t(b),t(_),D(()=>P(u,i(s).serialized)),h(n,_)},$$slots:{summary:!0,default:!0}}),h(o,v),J()}var Rt=(o,e,a)=>{const s=e.create();a.project.create_scene(s)},Vt=x('<button type="button"><span class="size_xl3 mr_sm"> </span> </button>'),qt=x('<div><button type="button"> </button></div>'),Ut=x('<h3>Load scene</h3> <section class="row gap_md flex_wrap"></section>',1),Xt=x('<h2 class="mt_xl">Scenes</h2> <h3>Create new scene</h3> <section class="row gap_md flex_wrap"></section> <!>',1);function Xe(o,e){E(e,!0);var a=Xt(),s=l(B(a),4);je(s,20,()=>ut,m=>m,(m,f)=>{var c=Vt();c.__click=[Rt,f,e];var n=r(c),d=r(n,!0);t(n);var _=l(n);t(c),D(()=>{q(c,"title",`create scene: ${f.name??""}`),P(d,f.glyph),P(_,` ${f.name??""}`)}),h(m,c)}),t(s);var v=l(s,2);{var p=m=>{var f=Ut(),c=l(B(f),2);je(c,21,()=>e.project.scenes,n=>n.id,(n,d)=>{var _=qt();const g=F(()=>e.project.selected_scene_id===i(d).id);var u=r(_);let b;u.__click=function(...j){var k;(k=i(g)?void 0:()=>{i(d).load(),e.project.select_scene(i(d).id)})==null||k.apply(this,j)};var w=r(u);t(u),t(_),D(j=>{b=Me(u,1,"white_space_nowrap",null,b,j),P(w,`${i(d).glyph??""}
					${i(d).name??""}`)},[()=>({selected:i(g)})]),O(3,_,()=>M,()=>({axis:"x"})),h(n,_)}),t(c),h(m,f)};C(v,m=>{e.project.scenes.length&&m(p)})}h(o,a),J()}X(["click"]);var Gt=(o,e,a)=>{const{value:s}=o.currentTarget;z(e,mt(s),!0),i(e)===null&&(a().glyph=s)},Ht=x('<div><strong class="color_c_5"> </strong></div>'),Kt=x('<header class="row mb_lg size_xl3"><span class="icon_size_lg pr_xl"> </span> </header> <form class="flex flex_column gap_md width_sm"><label><div class="title">name</div> <input placeholder="project name"></label> <label><div class="title">glyph</div> <input placeholder="project glyph"> <!></label></form>',1);function Qt(o,e){E(e,!0);const a=V(e,"project",7);let s=N(null);var v=Kt(),p=B(v),m=r(p),f=r(m,!0);t(m);var c=l(m);t(p);var n=l(p,2),d=r(n),_=l(r(d),2);ne(_),t(d);var g=l(d,2),u=l(r(g),2);ne(u),u.__input=[Gt,s,a];var b=l(u,2);{var w=j=>{var k=Ht(),T=r(k),y=r(T,!0);t(T),t(k),D(()=>P(y,i(s))),O(3,k,()=>M),h(j,k)};C(b,j=>{i(s)&&j(w)})}t(g),t(n),D(()=>{P(f,a().glyph),P(c,` ${a().name??""}`),q(_,"title",`project name for ${a().glyph??""}`),ze(u,a().glyph),q(u,"title",`project glyph for ${a().name??""}`)}),De(_,()=>a().name,j=>a().name=j),h(o,v),J()}X(["input"]);var Yt=(o,e)=>z(e,!i(e)),Zt=(o,e,a,s)=>{e.project.delete_scene(a.scene.id),z(s,!1)},$t=x('<div><button type="button" class="w_100 color_c selected deselectable"><div class="size_xl3">✕</div> <div class="ml_lg text_align_left">permanently delete scene<br> </div></button></div>'),ea=x('<button type="button" class="w_100 color_c">delete scene</button> <!>',1);function ta(o,e){E(e,!0);const a=pe.get();let s=N(!1);me(()=>{e.scene.id,z(s,!1)});var v=ea(),p=B(v);p.__click=[Yt,s];var m=l(p,2);{var f=c=>{var n=$t(),d=r(n);d.__pointerup=[Zt,a,e,s];var _=l(r(d),2),g=l(r(_),2);t(_),t(d),t(n),D(()=>P(g,`${e.scene.glyph??""}
				${e.scene.name??""}`)),O(3,n,()=>M),h(c,n)};C(m,c=>{i(s)&&c(f)})}h(o,v),J()}X(["click","pointerup"]);var aa=(o,e,a)=>{const{value:s}=o.currentTarget;z(e,pt(s),!0),i(e)===null&&(a().glyph=s)},ra=x('<div><strong class="color_c_5"> </strong></div>'),sa=(o,e)=>e().save(),na=(o,e)=>e().project.duplicate_scene(e()),la=x('<form class="flex flex_column gap_md width_sm"><fieldset><label><div class="title">name</div> <input placeholder="scene name" title="scene name"></label> <label><div class="title">glyph</div> <input placeholder="scene glyph"> <!></label> <label><div class="title">id</div> <input disabled title="scene id"></label></fieldset> <fieldset class="gap_md"><button type="button" class="color_a">save scene</button> <button type="button">duplicate scene</button></fieldset> <fieldset><h3 class="color_c_5">Delete scene</h3> <!></fieldset></form>');function Ge(o,e){E(e,!0);const a=V(e,"scene",7);let s=N(null);var v=la(),p=r(v),m=r(p),f=l(r(m),2);ne(f),t(m);var c=l(m,2),n=l(r(c),2);ne(n),n.__input=[aa,s,a];var d=l(n,2);{var _=y=>{var S=ra(),A=r(S),G=r(A,!0);t(A),t(S),D(()=>P(G,i(s))),O(3,S,()=>M),h(y,S)};C(d,y=>{i(s)&&y(_)})}t(c);var g=l(c,2),u=l(r(g),2);ne(u),t(g),t(p);var b=l(p,2),w=r(b);w.__click=[sa,a];var j=l(w,2);j.__click=[na,a],t(b);var k=l(b,2),T=l(r(k),2);ta(T,{get scene(){return a()}}),t(k),t(v),D(()=>{ze(n,a().glyph),q(n,"title",`scene glyph for ${a().name??""}`),ze(u,a().id)}),De(f,()=>a().name,y=>a().name=y),h(o,v),J()}X(["input","click"]);var ia=x('<div class="panel relative"><pre class="p_xs mb_0 svelte-1a9oeig"> </pre> <div class="absolute"><!></div></div>'),oa=x('<h2 class="mt_xl">Project data</h2> <section><!></section> <!>',1);function ca(o,e){E(e,!0);const a=F(()=>new de(e.project.json));var s=oa(),v=l(B(s),2),p=r(v);qe(p,{get data(){return i(a)},title:"project data",name:"Project",onimport:(f,c)=>{var n;e.project.set_json(Le(f)),(n=e.onimport)==null||n.call(e,f,c)}}),t(v);var m=l(v,2);Re(m,{summary:c=>{te();var n=ke("View raw project data");h(c,n)},children:(c,n)=>{var d=ia(),_=r(d),g=r(_,!0);t(_);var u=l(_,2);Pe(u,"",{},{right:"var(--size_lg)",top:"var(--size_lg)"});var b=r(u);Te(b,{get text(){return i(a).serialized}}),t(u),t(d),D(()=>P(g,i(a).serialized)),h(c,d)},$$slots:{summary:!0,default:!0}}),h(o,s),J()}var _a=(o,e)=>z(e,!i(e)),va=(o,e,a,s)=>{var v;e.delete_project(a.project.id),z(s,!1),(v=o.currentTarget.closest(".dialog"))==null||v.scrollTo({top:0,behavior:"smooth"})},da=x('<div><button type="button" class="w_100 color_c selected deselectable"><div class="size_xl3">✕</div> <div class="ml_lg text_align_left">permanently delete project<br> </div></button></div>'),ua=x('<button type="button" class="w_100 color_c">delete project</button> <!>',1);function ma(o,e){E(e,!0);const a=pe.get();let s=N(!1);me(()=>{e.project.id,z(s,!1)});var v=ua(),p=B(v);p.__pointerup=[_a,s];var m=l(p,2);{var f=c=>{var n=da(),d=r(n);d.__pointerup=[va,a,e,s];var _=l(r(d),2),g=l(r(_),2);t(_),t(d),t(n),D(()=>P(g,`${e.project.glyph??""}
				${e.project.name??""}`)),O(3,n,()=>M),h(c,n)};C(m,c=>{i(s)&&c(f)})}h(o,v),J()}X(["pointerup"]);var pa=x('<div class="w_100 py_xs"><button type="button"><div class="size_xl3 mr_lg"> </div> <div class="ellipsis"> </div></button></div>'),fa=(o,e)=>{e.create_project(Le({name:ht(e.projects),scenes:[ft(gt())]}))},ha=x('<div class="pane p_lg width_sm"><h2 class="mt_0 mb_lg row pr_md"><span class="icon_size_md mr_lg">🏞</span> projects</h2> <div class="flex flex_column flex_wrap w_100"><!> <button type="button" title="create a new project" class="w_100 mt_xs justify_content_start"><div class="row white_space_nowrap"><span class="size_xl3 mr_lg line_height_1">+</span> create new project</div></button></div></div>'),ga=x('<span class="size_xl">🔮</span>'),ba=(o,e)=>z(e,!i(e)),xa=()=>{localStorage.clear(),location.reload()},ya=x('<div><button type="button" class="w_100 color_c selected deselectable"><div class="size_xl3">✕</div> <div class="ml_lg text_align_left">permanently delete<br>all locally saved data</div></button></div>'),wa=x('<div class="pane p_xl mb_xl3"><section><!></section> <section><!></section></div> <div class="pane p_xl mb_xl3"><section><!></section> <section><h3>Edit scene</h3> <!></section></div> <div class="pane p_lg mb_xl3"><!></div> <div class="pane p_xl mb_xl3 shadow_c_xl"><h2 class="mt_xl color_c_5 font_weight_600">Danger zone</h2> <section class="width_sm"><!></section> <section><h3 class="mt_xl">Storage</h3> <div><p class="width_sm">Data is saved locally on your computer using <!>.</p>  <div class="width_sm"><button type="button" class="w_100 color_c">clear all saved data</button> <!></div></div></section></div>',1),ja=x('<div class="main_menu svelte-on5y3y"><div class="sidebar svelte-on5y3y"><!> <div class="box"><div class="box pane p_xs2"><div class="box p_xl3 gap_xl3 radius_sm shadow_md"><!> <nav><ul class="flex flex_column gap_sm unstyled"><li><a class="chip w_100 box px_md py_xs">demos</a></li> <li><a class="chip w_100 box px_md py_xs">about</a></li> <li><a class="chip w_100 box p_md pb_xs white_space_nowrap" href="https://github.com/ryanatkn/dealt"><!> source</a></li></ul></nav></div></div></div> <div class="box"><div class="box row pane"><div class="icon_size_lg" title="dealt">🔮</div></div></div></div> <div class="content svelte-on5y3y"><!></div></div>');function za(o,e){E(e,!0);let a=N(!1);const s=pe.maybe_get(),v=F(()=>s==null?void 0:s.project);Ve(()=>{e.app.show_main_menu&&e.app.close_main_menu()});var p=ue(),m=B(p);{var f=c=>{Oe(c,{get onclose(){return e.app.close_main_menu},layout:"page",children:(n,d)=>{var _=ja(),g=r(_),u=r(g);{var b=I=>{var U=ha(),W=l(r(U),2),H=r(W);je(H,16,()=>s.projects,K=>K,(K,L,oe,ce)=>{var Q=pa();const Y=F(()=>s.selected_project_id===L.id);var R=r(Q);let Z;R.__click=function(...ee){var re;(re=i(Y)?void 0:()=>{s.select_project(L.id)})==null||re.apply(this,ee)},Pe(R,"",{},{"flex-wrap":"nowrap"});var ae=r(R),_e=r(ae,!0);t(ae);var $=l(ae,2),ge=r($,!0);t($),t(R),t(Q),D(ee=>{q(R,"title",i(Y)?`${L.glyph} ${L.name} is selected`:`select project ${L.glyph} ${L.name}`),Z=Me(R,1,"w_100 color_d text_align_left justify_content_start",null,Z,ee),P(_e,L.glyph),P(ge,L.name)},[()=>({selected:i(Y)})]),O(3,Q,()=>M),h(K,Q)});var he=l(H,2);he.__click=[fa,s],t(W),t(U),h(I,U)};C(u,I=>{s&&I(b)})}var w=l(u,2),j=r(w),k=r(j),T=r(k);Ct(T,{children:(I,U)=>{var W=ga();h(I,W)},$$slots:{default:!0}});var y=l(T,2),S=r(y),A=r(S),G=r(A);q(G,"href",`${Fe??""}/demo`),t(A);var fe=l(A,2),He=r(fe);q(He,"href",`${Fe??""}/about`),t(fe);var Ae=l(fe,2),Ce=r(Ae),Ke=r(Ce);We(Ke,{data:Tt,size:"var(--icon_size_md)"}),te(),t(Ce),t(Ae),t(S),t(y),t(k),t(j),t(w),te(2),t(g);var Be=l(g,2),Qe=r(Be);{var Ye=I=>{var U=wa(),W=B(U),H=r(W),he=r(H);Qt(he,{get project(){return i(v)}}),t(H);var K=l(H,2),L=r(K);ca(L,{get project(){return i(v)}}),t(K),t(W);var oe=l(W,2),ce=r(oe),Q=r(ce);Xe(Q,{get project(){return s.project}}),t(ce);var Y=l(ce,2),R=l(r(Y),2);Ge(R,{get scene(){return s.project.scene}}),t(Y),t(oe);var Z=l(oe,2),ae=r(Z);Ue(ae,{get scene(){return s.project.scene}}),t(Z);var _e=l(Z,2),$=l(r(_e),2),ge=r($);ma(ge,{get project(){return i(v)}}),t($);var ee=l($,2),re=l(r(ee),2),be=r(re),Ze=l(r(be));Jt(Ze,{path:"Web/API/Window/localStorage"}),te(),t(be);var Ee=l(be,2),Je=r(Ee);Je.__click=[ba,a];var $e=l(Je,2);{var et=xe=>{var ve=ya(),tt=r(ve);tt.__pointerup=[xa],t(ve),O(3,ve,()=>M),h(xe,ve)};C($e,xe=>{i(a)&&xe(et)})}t(Ee),t(re),t(ee),t(_e),h(I,U)};C(Qe,I=>{s&&i(v)&&I(Ye)})}t(Be),t(_),h(n,_)},$$slots:{default:!0}})};C(m,c=>{e.app.show_main_menu&&c(f)})}h(o,p),J()}X(["click","pointerup"]);var ka=x('<div class="column width_md gap_xl3 mx_auto"><div class="pane p_lg"><section><!></section> <section><h3>Edit scene</h3> <!></section></div> <div class="pane p_lg"><!></div></div>');function Sa(o,e){E(e,!0);const a=V(e,"editor",7);Ve(()=>{a().show_scene_menu&&(a().show_scene_menu=!1)});var s=ue(),v=B(s);{var p=m=>{Oe(m,{onclose:()=>a().show_scene_menu=!a().show_scene_menu,layout:"page",children:(f,c)=>{var n=ka(),d=r(n),_=r(d),g=r(_);Xe(g,{get project(){return a().project}}),t(_);var u=l(_,2),b=l(r(u),2);Ge(b,{get scene(){return a().project.scene}}),t(u),t(d);var w=l(d,2),j=r(w);Ue(j,{get scene(){return a().project.scene}}),t(w),t(n),h(f,n)},$$slots:{default:!0}})};C(v,m=>{a().show_scene_menu&&m(p)})}h(o,s),J()}var Da=x("<!> <!> <!>",1),Pa=x("<!> <!>",1);function Ua(o,e){E(e,!0);const a=new bt(wt,"pixi",300,300),s=ot.set(new ct({renderer:a}));xt.set(s.clock),globalThis.app=s;const v=pe.set(new yt({app:s}));let p=!1;me(()=>{const n=s.json;p?(console.log("[layout] saving app json",n),s.save(n)):(console.log("[layout] initing app json",n),p=!0)});var m=Pa();nt(n=>{it.title="Dealt: editor"});var f=B(m);_t(f,{});var c=l(f,2);vt(c,{children:(n,d)=>{var _=Da(),g=B(_);Se(g,()=>e.children);var u=l(g,2);za(u,{app:s});var b=l(u,2);Sa(b,{editor:v}),h(n,_)}}),h(o,m),J()}export{Ua as component};
